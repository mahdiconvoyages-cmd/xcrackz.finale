/**
 * Optimisations spécifiques mobile
 * Désactive les animations lourdes et améliore les performances
 */

/* Détection mobile via media query */
@media (max-width: 768px) {
  /* Réduire les animations pour meilleures performances */
  *,
  *::before,
  *::after {
    animation-duration: 0.3s !important;
    transition-duration: 0.15s !important;
  }

  /* Désactiver les animations complexes sur mobile */
  .animate-ping,
  .animate-pulse,
  .animate-bounce,
  .animate-spin {
    animation: none !important;
  }

  /* Exception: garder le spin pour les loaders */
  .loading-spinner,
  [role="progressbar"],
  .spinner {
    animation: spin 1s linear infinite !important;
  }

  /* Désactiver backdrop-filter sur mobile (gourmand en ressources) */
  .backdrop-blur,
  .backdrop-blur-sm,
  .backdrop-blur-md,
  .backdrop-blur-lg,
  .backdrop-blur-xl {
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    background-color: rgba(255, 255, 255, 0.95) !important;
  }

  /* Réduire les ombres complexes */
  .shadow-2xl,
  .shadow-glow,
  .shadow-glow-teal {
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06) !important;
  }

  /* Optimiser les gradients (simplifier) */
  .bg-gradient-to-br,
  .bg-gradient-to-r,
  .bg-gradient-to-l {
    background-image: none !important;
    background-color: var(--fallback-color, #14b8a6) !important;
  }

  /* Désactiver les transformations 3D */
  .transform-3d,
  .perspective,
  [style*="transform: rotateY"],
  [style*="transform: rotateX"] {
    transform: none !important;
  }

  /* Limiter les will-change (consomme de la mémoire) */
  * {
    will-change: auto !important;
  }

  /* Optimiser le scroll */
  html,
  body {
    -webkit-overflow-scrolling: touch;
    scroll-behavior: auto !important; /* Désactiver smooth scroll */
  }

  /* Réduire la complexité des transitions hover sur mobile */
  *:hover {
    transition: none !important;
  }

  /* Optimiser les images */
  img {
    image-rendering: auto;
    -webkit-tap-highlight-color: transparent;
  }

  /* Désactiver les effets de parallaxe */
  [data-parallax],
  .parallax {
    transform: none !important;
  }

  /* Optimiser Leaflet map sur mobile */
  .leaflet-container {
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
  }

  .leaflet-tile {
    will-change: auto !important;
  }

  /* Réduire la complexité des cartes sur mobile */
  .leaflet-marker-icon,
  .leaflet-popup {
    animation: none !important;
  }

  /* Optimiser les modaux */
  .modal,
  .dialog,
  [role="dialog"] {
    backdrop-filter: none !important;
  }

  /* Performance: réduire la complexité visuelle des inputs */
  input,
  textarea,
  select {
    box-shadow: none !important;
    transition: border-color 0.15s ease-in-out !important;
  }

  /* Désactiver les animations de skeleton loading */
  .skeleton,
  .animate-shimmer {
    animation: none !important;
    background: #e5e7eb !important;
  }
}

/* Optimisations spécifiques iOS */
@supports (-webkit-touch-callout: none) {
  /* iOS Safari optimizations */
  * {
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-callout: none;
  }

  body {
    cursor: pointer;
  }

  /* Éviter les problèmes de fixed positioning sur iOS */
  .fixed {
    position: -webkit-sticky;
    position: sticky;
  }
}

/* Mode économie d'énergie du navigateur */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* Optimisation pour les connexions lentes */
@media (prefers-reduced-data: reduce) {
  /* Désactiver les images de fond */
  .bg-image,
  [style*="background-image"] {
    background-image: none !important;
  }

  /* Simplifier les effets visuels */
  .shadow,
  .border,
  .gradient {
    box-shadow: none !important;
    border: 1px solid #e5e7eb !important;
    background-image: none !important;
  }
}
